<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>由一道寻找唯一数字的题想到的 | reallocvoid</title>
  <meta name="author" content="xuangong">
  
  <meta name="description" content="最近本科室友发消息来问了一道题，引发了我一连串的好奇心。
P.S. 据师兄说这类问题貌似某书上有说过，可是已经不记得了，汗。。只怪肚子里的墨水太少，事实证明我这种庸人就应该事儿多^_^！
1.有很多数字，其中两两一样，只有一个数字不同，找出这个数字？

可以把让每个数字按位异或，最后得到的就是那个数字，这个是很基础的想法。时间复杂度O(n)，空间是O(1)，not bad.
扩展**
2.如果有两个数字是唯一的，怎么找出这两个数字？

处理两遍，第一遍先按位异或，最后肯定得到的是一个不为零的数字，然后按照一个不为零的bit来划分所有的整数，得到两个集合，每个集合都符合第1题的情况，分别对两个集合处理，就能找到这两个数字。
继续扩展**">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="由一道寻找唯一数字的题想到的"/>
  <meta property="og:site_name" content="reallocvoid"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/feed.xml" title="reallocvoid" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">reallocvoid</a></h1>
  <h2><a href="/"></a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
      <li><a href="/atom.xml">RSS</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-06-27T17:43:59.000Z"><a href="/2014/06/28/find-the-special-num/">6月 28 2014</a></time>
      
      
  
    <h1 class="title">由一道寻找唯一数字的题想到的</h1>
  

    </header>
    <div class="entry">
      
        <p>最近本科室友发消息来问了一道题，引发了我一连串的好奇心。</p>
<p>P.S. 据师兄说这类问题貌似某书上有说过，可是已经不记得了，汗。。只怪肚子里的墨水太少，事实证明我这种庸人就应该事儿多^_^！</p>
<h3 id="1-">1.有很多数字，其中两两一样，只有一个数字不同，找出这个数字？</h3>
<hr>
<p>可以把让每个数字按位异或，最后得到的就是那个数字，这个是很基础的想法。时间复杂度O(n)，空间是O(1)，not bad.
扩展**
2.如果有两个数字是唯一的，怎么找出这两个数字？</p>
<hr>
<p>处理两遍，第一遍先按位异或，最后肯定得到的是一个不为零的数字，然后按照一个不为零的bit来划分所有的整数，得到两个集合，每个集合都符合<strong>第1题</strong>的情况，分别对两个集合处理，就能找到这两个数字。
继续扩展**
<a id="more"></a>
3.如果有三个数字是唯一的，怎么找出这三个数字？</p>
<p>OK，这个问题还是要转换到之前的问题上去，和第2问一样，我们怎么样才能把这三个数字给分开。
这三个数字是唯一的，其他的数字都是配对的，那我们还是按bit来分类呗。<strong>第2题</strong>先全部异或一遍，来精确找到各个唯一数字之间的差别的方法已经不好用了。（因为三个互异的数字异或完全可以等于0，又不能不异或，要不其他的配对数字就会产生<code>不想要</code>的贡献）
既然不能精确的知道这些唯一的数字到底那地方不通，那就暴力一点吧，咱们就假设可以按照一位来分割，比如<code>the first bit</code>，按照这一位来划分集合，只有两种情况，这三个数字被分割成两个集合，各个集合中包含目标数字个数总共就这么几种情况：<code>1|2、2|1、0|3、3|0</code>。我们需要统计分成的两组的数字个数。</p>
<p>如果分成1个和2个，到此成功把问题转化成了第2问和第1问，O(n)解决战斗。</p>
<p>如果分成0个和3个就讨厌了，问题并没有解决，甚至问题规模都不一定会减小。
咱们怎么来区分出这两种情况呢，不管集合中有1个还是2个<strong>目标数字</strong>，集合中元素异或起来都绝对非0。既然有0个<strong>目标数字</strong>的集合异或必然是0，异或可以解决问题。为了减少计算量，可以在分组的时候提前统计集合元素的数目，对大小为偶数的集合进行异或（为0就是含<strong>目标数字</strong>0个，非0就是含<strong>目标数字</strong>2个），奇数个的元素就自生自灭不管它。</p>
<p>现在我们成功的解决了第一种情况，事情进展的比预想的好一些，0个和3个<strong>目标数字</strong>咋办？问题规模还不一定减少，这。。。
想到这里，需要去喝点东西，45度角仰望天空看看天台上的意大利球迷。终于发现，问题卡壳是思维定势了。</p>
<p>虽然乍看下来，按一位分组，可能问题规模没有减小(分成0个和3个的情况)。。可是题目中说的是3个<strong>目标数字</strong>互异，也就是说不可能每一位都把3个<strong>目标数字</strong>都分到一边，只要把32位都按上面的方法分组过一遍，一定能把<strong>目标数字</strong>分成1个和2个的分组情况。这个复杂度可不是n方，数字的位数是定长的，最多也就32n，问题到此算是圆满解决了。</p>
<p>P.S. 这种方法我并不能推广到更多的目标数字去，如果你有更好的更通用的方法，请留言或者email告知我，邮箱在文章末尾</p>
<p><strong>往另一个方向上扩展</strong></p>
<h3 id="4-">4.如果数字都是三个一组相同，只有一个数字唯一，应该怎么找出这个数字？</h3>
<p>可以统计所有集合中每一位的出现情况，是三的倍数的就不管了，不是三的倍数的就是从<strong>目标数字</strong>中来的，这样用int variable[32]来计数就可以了，这样写没问题。</p>
<p>这个问题其实可以联系到前3个题目上，让我们进一步来寻找这个问题的不变式，联想第1个问题，两两相同的时候，可以按位异或。按位异或就是针对每个bit相同为0，不同为1，用一个整数来记录异或的结果，就是记录每个bit的状态转移，一个bit只要出现的次数是2的倍数就得是0，否则是1，最后就求解成功。</p>
<p>现在的问题是三个一组相同，其实就是每一个bit出现的次数是3的整数倍，就应该是0。很清楚了，尼玛可以想办法来记录0-1-2-0的状态转移啊...怎么表示这个状态转移呢，只需要两位就能表示三个状态了(这里可以扩展)，<strong>bingo</strong></p>
<p>我们设置两个整数a和b，其中a和b的第n个bit(共2个bit)就代表了集合中数字第n个bit出现1次数的状态情况(mod 3下:0-1-2-0)。这就是这个问题开头说的不变式，按位来看每一位的状态转移规则是完全相同的，就可以把这些需要处理的位搁在一起放好，组成整数一块计算(32bit)。</p>
<p>代码如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="code"><pre><span class="comment">//ones as a bitmask to represent the ith bit had appeared once.</span>
<span class="comment">//twos as a bitmask to represent the ith bit had appeared twice.</span>
<span class="comment">//threes as a bitmask to represent the ith bit had appeared three times.</span>
<span class="keyword">int</span> singleNumber(<span class="keyword">int</span> A[], <span class="keyword">int</span> n) {
    <span class="keyword">int</span> ones = <span class="number">0</span>, twos = <span class="number">0</span>, threes = <span class="number">0</span>;
    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) {
        twos |= ones &amp; A[i];
        ones ^= A[i];
        threes = ones &amp; twos;
        ones &amp;= ~threes;
        twos &amp;= ~threes;
    }
    <span class="keyword">return</span> ones;
}
</pre></td></tr></table></figure>

<p>上面的代码中真正参加标识状态只需要两个变量，即ones和twos，其中threes是用来标记辅助置0状态的。
可以把这第三个变量优化掉。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
</pre></td><td class="code"><pre><span class="keyword">int</span> singleNumber(<span class="keyword">int</span> A[], <span class="keyword">int</span> n)
{
    <span class="keyword">int</span> ones = <span class="number">0</span>, twos = <span class="number">0</span>;
    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)
    {
        ones = (ones ^ A[i]) &amp; ~twos;
        twos = (twos ^ A[i]) &amp; ~ones;
    }
    <span class="keyword">return</span> ones;
}
</pre></td></tr></table></figure>


<p><strong>P.S. 仅抛砖引玉，欢迎继续扩展讨论，欢迎发邮件到 <code>zhangxian1124@bupt.edu.cn</code> 告知我，十分感谢^_^！</strong></p>

      
    </div>
    <footer>
      
        
        
  
  <div class="tags">
    <a href="/tags/algorithm/">algorithm</a>
  </div>

        
  <div class="addthis addthis_toolbox addthis_default_style">
    
      <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
    
    
      <a class="addthis_button_tweet"></a>
    
    
      <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    
    
      <a class="addthis_button_pinterest_pinit" pi:pinit:layout="horizontal"></a>
    
    <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js"></script>

      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">
  <h1 class="title">留言</h1>

  
      <div id="fb-root"></div>
<script>
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=123456789012345";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>

<div class="fb-comments" data-href="http://yoursite.com/2014/06/28/find-the-special-num/" data-num-posts="5" data-width="840" data-colorscheme="light"></div>
      
  
</section>

</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="搜索">
    <input type="hidden" name="q" value="site:yoursite.com">
  </form>
</div>

  

  
<div class="widget tag">
  <h3 class="title">标签</h3>
  <ul class="entry">
  
    <li><a href="/tags/DP/">DP</a><small>1</small></li>
  
    <li><a href="/tags/algorithm/">algorithm</a><small>5</small></li>
  
    <li><a href="/tags/c/">c</a><small>1</small></li>
  
    <li><a href="/tags/data structure/">data structure</a><small>1</small></li>
  
    <li><a href="/tags/linux/">linux</a><small>1</small></li>
  
    <li><a href="/tags/personal/">personal</a><small>1</small></li>
  
    <li><a href="/tags/protocol/">protocol</a><small>1</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2014 xuangong
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>